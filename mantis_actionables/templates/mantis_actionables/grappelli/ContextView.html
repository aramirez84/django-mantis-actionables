{% extends "mantis_actionables/grappelli/base_lists_two_column.html" %}
{% load actionables_tags %}
{% load dingos_tags %}

{% load tagging_widgets %}

{% block left_column %}


      {% show_ContextMetaData context_obj=view.curr_context_object widget_config=ContextMetaDataWidgetConfig %}


    <div class="grp-module grp-collapse grp-open">
      <h2 class="grp-collapse-handler">Singleton Observables tagged with "{{ view.curr_context_name }}"</h2>

      <div class="grp-module grp-changelist-results">

        {% if is_paginated %}
                    {%  render_paginator  %}
                {% endif %}


        <table id="result_list" cellspacing="0" class="grp-sortable">

        <thead>
         <tr>
           <th scope="col"  class="sortable column-identifier">
               {% render_table_ordering "type__name" "Type" %}

           </th>
           <th scope="col"  class="sortable column-identifier">
               {% render_table_ordering "subtype__name" "Subtype" %}

           </th>
           <th scope="col"  class="sortable column-identifier">
               {% render_table_ordering "value" "Value" %}

           </th>
           <th class="middle">Tags</th>
         </tr>
         </thead>
        <tbody>
         {% for object in object_list %}


         <tr class="grp-row grp-row-{% cycle 'odd' 'even' as odd_even %}">
           <td class="w-1 nowrap middle">{{ object.type.name }}</td>
           <td class="w-1 nowrap middle">{{ object.subtype.name }}</td>
           <td class="w-1 nowrap middle">{{ object.value }}</td>
           <td class="middle">
            <div id="tags" class="tag-block" data-obj-id="{{ object.pk }}" style="float: left;" data-curr-context="{{ view.curr_context_name }}">
            {% view_apply 'object2tags' object as tags%}
            {% if tags %}
              {% show_TagDisplay tags 'actionables' isEditable tag_context=view.curr_context_name%}
            {% endif %}
            </div>
          {% if isEditable %}
              {% show_addTagInput_actionables object.pk view.curr_context_name %}
          {% endif %}
          </td>
         {% for source in object.sources.all %}
           <tr class="grp-row grp-row-{{ odd_even }}">
            <td></td>
               <td></td>
               <td></td>
            <td colspan="1" class="w-1 nowrap middle">
	      {% if source.top_level_iobject_identifier %}
                {% url 'url.dingos.view.infoobject' pk=source.top_level_iobject_identifier.latest.pk as stix_obj_url %}

                {%  if stix_obj_url %}
		
                <a href="{{ stix_obj_url }}">
                    {{source.top_level_iobject_identifier.namespace.uri}}  '{{ source.top_level_iobject_identifier.latest.name }}'
                </a>
                {% endif %}

              {% else %}
                {% url  'actionables_import_info_details' pk=source.import_info.pk as import_info_url %}
                {%  if import_info_url %}
                <a href="{{ import_info_url }}">
                    {{source.import_info.namespace.uri}} '{{ source.import_info.name }}'
                </a>
                {% endif %}
	      {% endif %}

            </td>

           </tr>
         {% endfor %}
         {% endfor %}
        </tbody>
       </table>
        {% if is_paginated %}
                    {%  render_paginator  %}
                {% endif %}



    </div>
   </div>

    {% show_TaggedThings tag=view.curr_context_name  %}





{% include 'autocomplete_light/static.html' %}
{% include "dingos/grappelli/includes/_TaggingDialogs.html" %}
{% endblock %}
